"use strict";!function(l){var c=".acf-field-5d25148656536",n=".acf-field-5d25156b56537",d=".acf-field-5d251671a38b3",o=".acf-field-5d4a0a0c75c12";function a(){g(),l(".savedTag").remove(),l(".acf-input").show(),l(c+" select, "+n+" select, "+d+" select, "+o+" select").show().val("").trigger("change"),h()}function s(){location.reload()}function p(e){var t=l(" .tag-ordertype");l(c+" select").hide(),t&&t.remove(),l(c).append("<p class='savedTag tag-ordertype'>"+e+"</p>")}function f(e){var t=l(" .tag-sales");l(n+" .acf-input").hide(),t&&t.remove(),l(n).append("<p class='savedTag tag-sales'>"+e[0].text+"</p>")}function u(e){var t=l(" .tag-affiliate");l(d+" .acf-input").hide(),t&&t.remove(),0<e.length?l(d).append("<p class='savedTag tag-affiliate'>"+e[0].text+"</p>"):l(d).append("<p class='savedTag tag-affiliate'>N/A</p>")}function g(){var e={ordertypeVal:"",ordertype:"",salesRep:{},affiliate:{}};Cookies.set("truecustomtags",{ordertypeVal:e.ordertypeVal,ordertype:e.ordertype,salesRep:e.salesRep,affiliate:e.affiliate})}function h(){var e=Cookies.getJSON("truecustomtags");console.log(e)}function e(e,t,a){l("body").hasClass("page-template-page-oliver-pos-php")&&e.addEventListener(t,a,!1)}jQuery(document).ready(function(i){if(i("body").hasClass("single-product")&&i(".single_add_to_cart_button").wrapInner("<span></span>"),i("body").hasClass("term-bats")&&i(".uabb-woo-product-category").text(function(){return i(this).text().replace("Bats","TRUE / 2020")}),i("body").hasClass("page-id-671")&&(i("#affwp-user-login").parent().prepend("<p class='helper'>Please choose a recognizable user name for you or your organization. Do not include any special characters. This CAN NOT be changed later. </p>"),i("#affwp-register-form legend").after("<p class='helper'>The TRUE Affiliate program is invite only! To apply, you'll need a referral code that is sent to your email. Please enter that below. </p>")),i("body").hasClass("page-template-page-oliver-pos-php")){var e=Cookies.getJSON("truecustomtags");null==e?g():(e.ordertype&&p(e.ordertype),0<e.salesRep.length&&f(e.salesRep),0<e.affiliate.length&&u(e.affiliate)),console.log("INITIAL COOKIE"),console.log(e),i("#acf-form").contents().unwrap(),i(".acf-field-select, .acf-field-user").wrap("<div class='col-4'></div>"),i(".acf-field-post-object").wrap("<div class='col-6'></div>"),i(".acf-fields").addClass("row"),i(".acf-button, .ticket-data").hide();var t=i(o+" select");t.select2(),t.on("select2:select",function(e){var t=i(o+" select").select2("data");if(t[0].id)var a=t[0].text.match(/([0-9]+) .*? /)[1];var s={action:"get_ticket_info",ticketOrderID:a,ticketID:t[0].id};return console.log(s),i.ajax({url:truefunction.ajax_url,type:"get",data:s,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){i("#loader").show(),i(".ticket-data").hide(),i("#customtags_button").addClass("disabled")},success:function(e){!function(e){console.log(e),l(".ticket-data").show(),l("#event-title").text(e.event_meta.post_title),l("#event-date").text(e.event_date),l("#ticket-orderid").text(e.ticketOrderID),l("#ticket-id").text(e.attendee_info[0].attendee_id),l("#ticket-num").text(e.attendee_info[0].ticket_id),l("#ticket-type").text(e.attendee_info[0].ticket_name),l("#ticket-purchaser").text(e.attendee_info[0].holder_name),l("#ticket-cost").text(e.attendee_metadata._paid_price[0]),l("#ticket-security").text(e.attendee_info[0].security_code),"completed"===e.ticketOrderStatus||"processing"===e.ticketOrderStatus?(l("#customtags_button").removeClass("disabled"),""===e.attendee_info[0].check_in?l("#ticket-checkin").text("Unused. You can apply this ticket to this order.").parent().addClass("alert-success").removeClass("alert-danger"):"1"===e.attendee_info[0].check_in?l("#ticket-checkin").text("USED. DO NOT APPLY to this order.").parent().addClass("alert-danger").removeClass("alert-success"):l("#ticket-checkin").text(e.attendee_info[0].check_in)):l("#ticket-checkin").text("ORDER "+e.ticketOrderStatus+". DO NOT APPLY to this order.").parent().addClass("alert-danger").removeClass("alert-success");l("#player-name").text(e.attendee_info[0].attendee_meta["players-name"].value)}(e)},error:function(e){console.log(JSON.stringify(e))},complete:function(e){i("#loader").hide()}}),!1}),t.on("select2:unselect",function(e){i(".ticket-data").hide(),i(".merge").empty(),i("#customtags_button").removeClass("disabled")})}i("#clearAllTags").on("click",a),i("#refreshPage").on("click",s)}),l(function(){var e={byRow:!0,property:"max-height",target:l(".matchThis"),remove:!1};l(".matchHeight").matchHeight(e)});var y=function(e){window.parent.postMessage(e,"*")};e(document.getElementById("customtags_button"),"click",function(e){if(console.log("POC"),!l(this).hasClass("disabled")){var t=l("#ticket-id").text(),a=l("#ticket-orderid").text(),s=l("#ticket-cost").text();if(""==(o=Cookies.getJSON("truecustomtags")).ordertypeVal){if(l(c+" select").val())var i=l(c+" option:selected").text();else i="";var o={ordertypeVal:l(c+" select").val(),ordertype:i,salesRep:l(n+" select").select2("data"),affiliate:l(d+" select").select2("data")}}if(""==o.ordertypeVal||0==o.salesRep.length)return g(),l(".savedTag").remove(),l(".acf-input").show(),l(c+" select, "+n+" select, "+d+" select").show().val("").trigger("change"),h(),void alert("Please Enter an Event Type and Sales Rep");if("league"!==o.ordertypeVal&&"facility_event"!==o.ordertypeVal||0!=o.affiliate.length){0<o.ordertypeVal.length&&p(o.ordertype),0<o.salesRep.length&&f(o.salesRep),u(o.affiliate),o.affiliate.length,Cookies.set("truecustomtags",{ordertypeVal:o.ordertypeVal,ordertype:o.ordertype,salesRep:o.salesRep,affiliate:o.affiliate}),h();var r={oliverpos:{event:"addData"},data:{customTags:{affiliateID:o.affiliate[0].id,salesRep:o.salesRep[0].id,orderType:o.ordertypeVal},ticket:{ticketNumber:t,ticketPrice:s,ticketOrderID:a}}};console.log("----- DATA TO OLIVER EXTENSION -----"),console.log(r),y(JSON.stringify(r))}else alert("This order type requires an affiliate")}}),e(document.getElementById("extension_finished"),"click",function(e){y(JSON.stringify({oliverpos:{event:"extensionFinished",wordpressAction:"tds_neworder"}}))})}(jQuery);