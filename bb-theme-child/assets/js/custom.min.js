"use strict";!function(r){var n=".acf-field-5d25148656536",c=".acf-field-5d25156b56537",d=".acf-field-5d251671a38b3",l=".acf-field-5d4a0a0c75c12";function f(){s(),console.log(n),r(".savedTag").remove(),r(".acf-input").show(),r(n+" select, "+c+" select, "+d+" select, "+l+" select").show().val("").trigger("change"),y()}function a(){location.reload()}function p(e){var t=r(" .tag-ordertype");r(n+" select").hide(),t&&t.remove(),r(n).append("<p class='savedTag tag-ordertype'>"+e+"</p>")}function u(e){var t=r(" .tag-sales");r(c+" .acf-input").hide(),t&&t.remove(),r(c).append("<p class='savedTag tag-sales'>"+e[0].text+"</p>")}function g(e){var t=r(" .tag-affiliate");r(d+" .acf-input").hide(),t&&t.remove(),0<e.length?r(d).append("<p class='savedTag tag-affiliate'>"+e[0].text+"</p>"):r(d).append("<p class='savedTag tag-affiliate'>N/A</p>")}function s(){var e={ordertypeVal:"",ordertype:"",salesRep:{},affiliate:{}};Cookies.set("truecustomtags",{ordertypeVal:e.ordertypeVal,ordertype:e.ordertype,salesRep:e.salesRep,affiliate:e.affiliate})}function y(){var e=Cookies.getJSON("truecustomtags");console.log(e)}function e(e,t,a){e.addEventListener(t,a,!1)}jQuery(document).ready(function(i){if(i("body").hasClass("single-product")&&i(".single_add_to_cart_button").wrapInner("<span></span>"),i("body").hasClass("term-bats")&&i(".uabb-woo-product-category").text(function(){return i(this).text().replace("Bats","TRUE / 2020")}),i("body").hasClass("page-template-page-oliver-pos-php")){var e=Cookies.getJSON("truecustomtags");null==e?s():(e.ordertype&&p(e.ordertype),0<e.salesRep.length&&u(e.salesRep),0<e.affiliate.length&&g(e.affiliate)),console.log("INITIAL COOKIE"),console.log(e),i("#acf-form").contents().unwrap(),i(".acf-field-select, .acf-field-user").wrap("<div class='col-4'></div>"),i(".acf-field-post-object").wrap("<div class='col-6'></div>"),i(".acf-fields").addClass("row"),i(".acf-button, .ticket-data").hide()}i("#send-acf-to-oliver").click(function(){var e=Cookies.getJSON("truecustomtags"),t=i(l+" select").select2("data");if(console.log(t),""==e.ordertypeVal){if(i(n+" select").val())var a=i(n+" option:selected").text();else a="";e={ordertypeVal:i(n+" select").val(),ordertype:a,salesRep:i(c+" select").select2("data"),affiliate:i(d+" select").select2("data")}}!function(e,t){if(console.log(t),""==e.ordertypeVal||0==e.salesRep.length)return f(),alert("Please Enter an Event Type and Sales Rep");if(("league"===e.ordertypeVal||"facility_event"===e.ordertypeVal)&&(console.log("IS LEAGUE"),0==e.affiliate.length))return alert("This order type requires an affiliate");0<e.ordertypeVal.length&&p(e.ordertype);0<e.salesRep.length&&u(e.salesRep);g(e.affiliate),e.affiliate.length;Cookies.set("truecustomtags",{ordertypeVal:e.ordertypeVal,ordertype:e.ordertype,salesRep:e.salesRep,affiliate:e.affiliate}),y()}(e,t)}),i("#clearAllTags").on("click",f),i("#refreshPage").on("click",a);var t=i(l+" select");t.select2(),t.on("select2:select",function(e){var t=i(l+" select").select2("data");if(t[0].id)var a=t[0].text.match(/([0-9]+) .*? /)[1];console.log(a);var s={action:"get_ticket_info",ticketOrderID:a,ticketID:t[0].id};return console.log(s),i.ajax({url:truefunction.ajax_url,type:"get",data:s,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){i("#loader").show(),i(".ticket-data").hide(),i("#customtags_button").addClass("disabled")},success:function(e){!function(e){console.log(e),r(".ticket-data").show(),r("#event-title").text(e.event_meta.post_title),r("#event-date").text(e.event_date),r("#ticket-orderid").text(e.ticketOrderID),r("#ticket-id").text(e.attendee_info[0].attendee_id),r("#ticket-num").text(e.attendee_info[0].ticket_id),r("#ticket-type").text(e.attendee_info[0].ticket_name),r("#ticket-purchaser").text(e.attendee_info[0].holder_name),r("#ticket-cost").text(e.attendee_metadata._paid_price[0]),r("#ticket-security").text(e.attendee_info[0].security_code),""===e.attendee_info[0].check_in?r("#ticket-checkin").text("Unused. You can apply this ticket to this order.").parent().addClass("alert-success").removeClass("alert-danger"):"1"===e.attendee_info[0].check_in?r("#ticket-checkin").text("USED. DO NOT APPLY to this order.").parent().addClass("alert-danger").removeClass("alert-success"):r("#ticket-checkin").text(e.attendee_info[0].check_in);r("#player-name").text(e.attendee_info[0].attendee_meta["players-name"].value)}(e)},error:function(e){console.log(JSON.stringify(e))},complete:function(e){i("#loader").hide(),i("#customtags_button").removeClass("disabled")}}),!1}),t.on("select2:unselect",function(e){i(".ticket-data").hide(),i(".merge").empty()})}),r(function(){var e={byRow:!0,property:"max-height",target:r(".matchThis"),remove:!1};r(".matchHeight").matchHeight(e)});var h=function(e){window.parent.postMessage(e,"*")};e(document.getElementById("customtags_button"),"click",function(e){if(console.log("POC"),!r(this).hasClass("disabled")){var t=r("#ticket-id").text(),a=r("#ticket-orderid").text(),s=r("#ticket-cost").text();if(""==(l=Cookies.getJSON("truecustomtags")).ordertypeVal){if(r(n+" select").val())var i=r(n+" option:selected").text();else i="";var l={ordertypeVal:r(n+" select").val(),ordertype:i,salesRep:r(c+" select").select2("data"),affiliate:r(d+" select").select2("data")}}if(""==l.ordertypeVal||0==l.salesRep.length)return f(),void alert("Please Enter an Event Type and Sales Rep");if("league"!==l.ordertypeVal&&"facility_event"!==l.ordertypeVal||0!=l.affiliate.length){0<l.ordertypeVal.length&&p(l.ordertype),0<l.salesRep.length&&u(l.salesRep),g(l.affiliate),l.affiliate.length,Cookies.set("truecustomtags",{ordertypeVal:l.ordertypeVal,ordertype:l.ordertype,salesRep:l.salesRep,affiliate:l.affiliate}),y();var o={oliverpos:{event:"addData"},data:{customTags:{affiliateID:l.affiliate[0].id,salesRep:l.salesRep[0].id,orderType:l.ordertypeVal},ticket:{ticketNumber:t,ticketPrice:s,ticketOrderID:a}}};h(JSON.stringify(o))}else alert("This order type requires an affiliate")}}),e(document.getElementById("extension_finished"),"click",function(e){h(JSON.stringify({oliverpos:{event:"extensionFinished",wordpressAction:"tds_neworder"}}))})}(jQuery);