"use strict";!function(r){var n=".acf-field-5d25148656536",l=".acf-field-5d25156b56537",d=".acf-field-5d251671a38b3",o=".acf-field-5d4a0a0c75c12";function a(){g(),r(".savedTag").remove(),r(".acf-input").show(),r(n+" select, "+l+" select, "+d+" select, "+o+" select").show().val("").trigger("change"),h()}function s(){location.reload()}function f(e){var t=r(" .tag-ordertype");r(n+" select").hide(),t&&t.remove(),r(n).append("<p class='savedTag tag-ordertype'>"+e+"</p>")}function p(e){var t=r(" .tag-sales");r(l+" .acf-input").hide(),t&&t.remove(),r(l).append("<p class='savedTag tag-sales'>"+e[0].text+"</p>")}function u(e){var t=r(" .tag-affiliate");r(d+" .acf-input").hide(),t&&t.remove(),0<e.length?r(d).append("<p class='savedTag tag-affiliate'>"+e[0].text+"</p>"):r(d).append("<p class='savedTag tag-affiliate'>N/A</p>")}function g(){var e={ordertypeVal:"",ordertype:"",salesRep:{},affiliate:{}};Cookies.set("truecustomtags",{ordertypeVal:e.ordertypeVal,ordertype:e.ordertype,salesRep:e.salesRep,affiliate:e.affiliate})}function h(){var e=Cookies.getJSON("truecustomtags");console.log(e)}function e(e,t,a){e.addEventListener(t,a,!1)}jQuery(document).ready(function(i){if(i("body").hasClass("single-product")&&i(".single_add_to_cart_button").wrapInner("<span></span>"),i("body").hasClass("term-bats")&&i(".uabb-woo-product-category").text(function(){return i(this).text().replace("Bats","TRUE / 2020")}),i("body").hasClass("page-template-page-oliver-pos-php")){var e=Cookies.getJSON("truecustomtags");null==e?g():(e.ordertype&&f(e.ordertype),0<e.salesRep.length&&p(e.salesRep),0<e.affiliate.length&&u(e.affiliate)),console.log("INITIAL COOKIE"),console.log(e),i("#acf-form").contents().unwrap(),i(".acf-field-select, .acf-field-user").wrap("<div class='col-4'></div>"),i(".acf-field-post-object").wrap("<div class='col-6'></div>"),i(".acf-fields").addClass("row"),i(".acf-button, .ticket-data").hide()}i("#clearAllTags").on("click",a),i("#refreshPage").on("click",s);var t=i(o+" select");t.select2(),t.on("select2:select",function(e){var t=i(o+" select").select2("data");if(t[0].id)var a=t[0].text.match(/([0-9]+) .*? /)[1];console.log(a);var s={action:"get_ticket_info",ticketOrderID:a,ticketID:t[0].id};return console.log(s),i.ajax({url:truefunction.ajax_url,type:"get",data:s,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){i("#loader").show(),i(".ticket-data").hide(),i("#customtags_button").addClass("disabled")},success:function(e){!function(e){console.log(e),r(".ticket-data").show(),r("#event-title").text(e.event_meta.post_title),r("#event-date").text(e.event_date),r("#ticket-orderid").text(e.ticketOrderID),r("#ticket-id").text(e.attendee_info[0].attendee_id),r("#ticket-num").text(e.attendee_info[0].ticket_id),r("#ticket-type").text(e.attendee_info[0].ticket_name),r("#ticket-purchaser").text(e.attendee_info[0].holder_name),r("#ticket-cost").text(e.attendee_metadata._paid_price[0]),r("#ticket-security").text(e.attendee_info[0].security_code),""===e.attendee_info[0].check_in?r("#ticket-checkin").text("Unused. You can apply this ticket to this order.").parent().addClass("alert-success").removeClass("alert-danger"):"1"===e.attendee_info[0].check_in?r("#ticket-checkin").text("USED. DO NOT APPLY to this order.").parent().addClass("alert-danger").removeClass("alert-success"):r("#ticket-checkin").text(e.attendee_info[0].check_in);r("#player-name").text(e.attendee_info[0].attendee_meta["players-name"].value)}(e)},error:function(e){console.log(JSON.stringify(e))},complete:function(e){i("#loader").hide(),i("#customtags_button").removeClass("disabled")}}),!1}),t.on("select2:unselect",function(e){i(".ticket-data").hide(),i(".merge").empty()})}),r(function(){var e={byRow:!0,property:"max-height",target:r(".matchThis"),remove:!1};r(".matchHeight").matchHeight(e)});var v=function(e){window.parent.postMessage(e,"*")};e(document.getElementById("customtags_button"),"click",function(e){if(console.log("POC"),!r(this).hasClass("disabled")){var t=r("#ticket-id").text(),a=r("#ticket-orderid").text(),s=r("#ticket-cost").text();if(""==(o=Cookies.getJSON("truecustomtags")).ordertypeVal){if(r(n+" select").val())var i=r(n+" option:selected").text();else i="";var o={ordertypeVal:r(n+" select").val(),ordertype:i,salesRep:r(l+" select").select2("data"),affiliate:r(d+" select").select2("data")}}if(""==o.ordertypeVal||0==o.salesRep.length)return g(),r(".savedTag").remove(),r(".acf-input").show(),r(n+" select, "+l+" select, "+d+" select").show().val("").trigger("change"),h(),void alert("Please Enter an Event Type and Sales Rep");if("league"!==o.ordertypeVal&&"facility_event"!==o.ordertypeVal||0!=o.affiliate.length){0<o.ordertypeVal.length&&f(o.ordertype),0<o.salesRep.length&&p(o.salesRep),u(o.affiliate),o.affiliate.length,Cookies.set("truecustomtags",{ordertypeVal:o.ordertypeVal,ordertype:o.ordertype,salesRep:o.salesRep,affiliate:o.affiliate}),h();var c={oliverpos:{event:"addData"},data:{customTags:{affiliateID:o.affiliate[0].id,salesRep:o.salesRep[0].id,orderType:o.ordertypeVal},ticket:{ticketNumber:t,ticketPrice:s,ticketOrderID:a}}};v(JSON.stringify(c))}else alert("This order type requires an affiliate")}}),e(document.getElementById("extension_finished"),"click",function(e){v(JSON.stringify({oliverpos:{event:"extensionFinished",wordpressAction:"tds_neworder"}}))})}(jQuery);